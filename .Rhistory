p1
# plotting the distribution of employees
p2 <- ggplot(data = wms, aes(x = emp_firm)) +
geom_histogram_da(binwidth = 200, type = "percent") +
labs(x = "Firm size (employment)", y = "Percent") +
scale_x_continuous(expand = c(0.01, 0.01), limits = c(0, 5000), breaks = seq(0, 5000, by = 1000)) +
scale_y_continuous(expand = c(0.00, 0.00), limits = c(0, 0.3), breaks = seq(0, 0.3, by = 0.05), labels = scales::percent_format(accuracy = 1)) +
theme_bg()
p2
# creating variable log
wms$lnemp = log(wms$emp_firm)
Hmisc::describe(wms$lnemp)
# plotting the natural log of number of employees
p3 <- ggplot(data = wms, aes(x = lnemp)) +
geom_histogram_da(binwidth = 0.25, type = "percent", boundary = 0) +
labs(x = "Firm size (ln(employment))", y = "Percent") +
scale_x_continuous(expand = c(0.01, 0.01), limits = c(4, 9)) +
scale_y_continuous(expand = c(0.00, 0.00), limits = c(0, 0.2), breaks = seq(0, 0.2, by = 0.04), labels = scales::percent_format(accuracy = 1)) +
theme_bg()
p3
# generating employment bins
wms$emp3bins <- ifelse(wms$emp_firm < 200, 1,
ifelse(wms$emp_firm >= 200 & wms$emp_firm < 1000, 2,
ifelse(wms$emp_firm >= 1000, 3, 100)
)
)
Hmisc::describe(wms$emp3bins)
# converting created variable as factor
wms$emp3bins <- as.factor(wms$emp3bins)
# creating new wms for lean management
wms_lean <- wms |>
dplyr::select(emp3bins, lean1) |>
dplyr::group_by(emp3bins, lean1) |>
dplyr::summarise(Count = n()) |>
dplyr::mutate(Percent = round(Count / sum(Count), digits = 5)) |>
dplyr::ungroup() # use %>% ungroup() when do multiple times group_by
# plotting lean management
p1 <- ggplot(data = wms_lean, aes(x = emp3bins, y = Percent, fill = factor(lean1, levels = rev(unique(lean1))))) +
geom_bar(stat = "identity", position = "fill", width = 0.6, color = "white", size = 0.5, alpha = 0.8) +
scale_y_continuous(expand = c(0, 0), limits = c(0, 1), breaks = seq(0, 1, by = 0.2), labels = scales::percent_format()) +
scale_x_discrete(labels = c("1" = "Small", "2" = "Medium", "3" = "Large")) +
scale_fill_manual(values = c(color[3], color[1], color[5], color[2], color[4]), name = NULL) +
labs(x = "Firm size (employment), 3 bins", y = "Percent", title = "Lean Management") +
theme_bg() +
theme(legend.position = "right")
p1
# creating new wms for performance tracking
wms_per <- wms |>
dplyr::select(emp3bins, perf2) |>
dplyr::group_by(emp3bins, perf2) |>
dplyr::summarise(Count = n()) |>
dplyr::mutate(Percent = round(Count / sum(Count), digits = 5)) |>
dplyr::ungroup()
# plotting performance tracking
p2 <- ggplot(data = wms_per, aes(x = emp3bins, y = Percent, fill = factor(perf2, levels = rev(unique(perf2))))) +
geom_bar(stat = "identity", position = "fill", width = 0.6, color = "white", size = 0.5, alpha = 0.8) +
scale_y_continuous(expand = c(0, 0), limits = c(0, 1), breaks = seq(0, 1, by = 0.2), labels = scales::percent_format()) +
scale_x_discrete(labels = c("1" = "Small", "2" = "Medium", "3" = "Large")) +
scale_fill_manual(values = c(color[3], color[1], color[5], color[2], color[4]), name = NULL) +
labs(x = "Firm size (employment), 3 bins", y = "Percent", title = "Performance Tracking") +
theme_bg() +
theme(legend.position = "right")
p2
# re-coding employee bins
wms$emp3bins <- ifelse(wms$emp3bins == 1, 150,
ifelse(wms$emp3bins == 2, 600,
ifelse(wms$emp3bins == 3, 3000, NA)
)
)
# summary
wms  |>
dplyr::select(emp_firm, emp3bins)  |>
dplyr::group_by(emp3bins)  |>
dplyr::summarise_all(tibble::lst(min, max, mean, median, sd, length))
# generating variables by mean (3 bins)
wms_mean03 <- wms  |>
dplyr::group_by(emp3bins)  |>
dplyr::summarize(management_emp3bins = mean(management))
# plotting conditional mean (3 bins of employment)
p1 <- ggplot(data = wms_mean03, aes(x = emp3bins, y = management_emp3bins)) +
geom_point(size = 2, color = color[3], fill = color[1], shape = 21, alpha = 0.8, na.rm = T) +
scale_y_continuous(expand = c(0.01, 0.01), limits = c(2.4, 3.4), breaks = seq(2.4, 3.4, by = 0.2)) +
scale_x_continuous(expand = c(0.01, 0.01), limits = c(0, 3000), breaks = seq(0, 3000, by = 500)) +
labs(x = "Firm size (employment), 3 bins", y = "Management score") +
theme_bg()
p1
# generating employment bins of 10
wms$emp10bins <- wms$emp_firm  |>  ggplot2::cut_number(10)
# summary
wms_summary <- wms  |>
dplyr::select(emp_firm, emp10bins)  |>
dplyr::group_by(emp10bins)  |>
dplyr::summarise_all(tibble::lst(min, max, mean, median, sd, length))
wms_summary
# re-coding
levels(wms$emp10bins) <- wms_summary  |>
dplyr::pull(mean)  |>
round()
wms$emp10bins <- as.numeric(levels(wms$emp10bins))[wms$emp10bins]
# summary
wms  |>
dplyr::select(emp_firm, emp10bins)  |>
dplyr::group_by(emp10bins)  |>
dplyr::summarise_all(tibble::lst(min, max, mean, median, sd, length))
# generating variables by mean (10 bins)
wms_mean10 <- wms  |>
dplyr::group_by(emp10bins)  |>
dplyr::summarize(management_emp10bins = mean(management))
# plotting conditional mean (10 bins of employment)
p2 <- ggplot(data = wms_mean10, aes(x = emp10bins, y = management_emp10bins)) +
geom_point(size = 2, color = color[3], fill = color[1], shape = 21, alpha = 0.8, na.rm = T) +
scale_y_continuous(expand = c(0.01, 0.01), limits = c(2.5, 3.5), breaks = seq(2.5, 3.5, by = 0.25)) +
scale_x_continuous(expand = c(0.01, 0.01), limits = c(0, 3500), breaks = seq(0, 3500, by = 500)) +
labs(x = "Firm size (employment), 10 bins", y = "Management score") +
theme_bg()
p2
# this is a simpler solution, similar looking graph (not in book):
binsreg::binsreg(wms$management, wms$emp_firm, nbins = 3)
binsreg::binsreg(wms$management, wms$emp_firm, nbins = 10)
# lintr::lint("main.Rmd", linters =
#               lintr::with_defaults(
#                 commented_code_linter = NULL,
#                 trailing_whitespace_linter = NULL
#                 )
#             )
# if you have additional scripts and want them to be linted too, add them here
# lintr::lint("scripts/my_script.R")
styler:::style_selection()
p3 <- ggplot(data = wms, aes(x = emp_firm, y = management)) +
geom_point(color = color[1], size = 1.5, shape = 16, alpha = 0.8, show.legend = FALSE, na.rm = TRUE) +
scale_x_continuous(expand = c(0.01, 0.01), limits = c(0, 5000), breaks = seq(0, 5000, by = 1000)) +
scale_y_continuous(expand = c(0.01, 0.01), limits = c(1, 5), breaks = seq(1, 5, 1)) +
labs(x = "Firm size (employment)", y = "Management score") +
theme_bg()
p3
styler:::style_selection()
df$lnemp = log(wms$emp_firm)
# creating log var
df$lnemp = log(wms$emp_firm)
# creating log var
df$lnemp <-  log(wms$emp_firm)
# creating log var
wms$lnemp <-  log(wms$emp_firm)
p4 <- ggplot(data = wms, aes(x = lnemp, y = management)) +
geom_point(color = color[1], size = 1.5, shape = 16, alpha = 0.8, show.legend = FALSE, na.rm = TRUE) +
scale_x_continuous(expand = c(0.01, 0.01), limits = c(4, 9), breaks = seq(4, 9, by = 1)) +
scale_y_continuous(expand = c(0.01, 0.01), limits = c(1, 5), breaks = seq(1, 5, 1)) +
labs(x = "Firm size (ln(employment))", y = "Management score") +
theme_bg()
p4
wms$emp3bins <- as.factor(wms$emp3bins)
levels(wms$emp3bins) <- c('Small','Medium', 'Large')
styler:::style_selection()
p5 <- ggplot(data = wms, aes(x = emp3bins, y = management)) +
stat_boxplot(aes(group = emp3bins), geom = "errorbar", width = 0.5, color = c(color[2], color[1], color[3]), size = 0.5, na.rm = T) +
geom_boxplot(aes(group = emp3bins), color = c(color[2], color[1], color[3]), fill = c(color[2], color[1], color[3]), size = 0.5, width = 0.5, alpha = 0.3, na.rm = T) +
labs(x = "Firm size (employment), 3 bins", y = "Management score") +
scale_y_continuous(expand = c(0.01, 0.01), limits = c(1, 5), breaks = seq(1, 5, 1)) +
#  geom_jitter(aes(color = emp3bins), position=position_jitter(0.1), size = 0.5, show.legend=F,  na.rm=TRUE) +
# scale_color_viridis(discrete = TRUE, option = "D", begin = 0, end=0.7)+
theme_bg()
p5
styler:::style_selection()
p6 <- ggplot(data = df, aes(x = emp3bins, y = management, color = emp3bins, fill = emp3bins)) +
geom_violin(aes(group = emp3bins), size = 0.3, alpha = 0.3, trim = F, show.legend = F, na.rm = TRUE) +
geom_boxplot(aes(group = emp3bins), color = c(color[2], color[1], color[3]), fill = c(color[2], color[1], color[3]), size = 0.5, width = 0.2, alpha = 0.3, na.rm = T) +
labs(x = "Firm size (employment), 3 bins", y = "Management score") +
scale_y_continuous(expand = c(0.01, 0.01), limits = c(0, 6), breaks = seq(0, 6, 1)) +
scale_color_manual(
name = "",
values = c(color[2], color[1], color[3])
) +
scale_fill_manual(
name = "",
values = c(color[2], color[1], color[3])
) +
theme_bg()
p6 <- ggplot(data = wms, aes(x = emp3bins, y = management, color = emp3bins, fill = emp3bins)) +
geom_violin(aes(group = emp3bins), size = 0.3, alpha = 0.3, trim = F, show.legend = F, na.rm = TRUE) +
geom_boxplot(aes(group = emp3bins), color = c(color[2], color[1], color[3]), fill = c(color[2], color[1], color[3]), size = 0.5, width = 0.2, alpha = 0.3, na.rm = T) +
labs(x = "Firm size (employment), 3 bins", y = "Management score") +
scale_y_continuous(expand = c(0.01, 0.01), limits = c(0, 6), breaks = seq(0, 6, 1)) +
scale_color_manual(
name = "",
values = c(color[2], color[1], color[3])
) +
scale_fill_manual(
name = "",
values = c(color[2], color[1], color[3])
) +
theme_bg()
p6
# re-coding employee bins
wms$emp3bins <- ifelse(wms$emp3bins == 1, 150,
ifelse(wms$emp3bins == 2, 600,
ifelse(wms$emp3bins == 3, 3000, NA)
)
)
# summary
wms  |>
dplyr::select(emp_firm, emp3bins)  |>
dplyr::group_by(emp3bins)  |>
dplyr::summarise_all(tibble::lst(min, max, mean, median, sd, length))
# generating variables by mean (3 bins)
wms_mean03 <- wms  |>
dplyr::group_by(emp3bins)  |>
dplyr::summarize(management_emp3bins = mean(management))
# plotting conditional mean (3 bins of employment)
p1 <- ggplot(data = wms_mean03, aes(x = emp3bins, y = management_emp3bins)) +
geom_point(size = 2, color = color[3], fill = color[1], shape = 21, alpha = 0.8, na.rm = T) +
scale_y_continuous(expand = c(0.01, 0.01), limits = c(2.4, 3.4), breaks = seq(2.4, 3.4, by = 0.2)) +
scale_x_continuous(expand = c(0.01, 0.01), limits = c(0, 3000), breaks = seq(0, 3000, by = 500)) +
labs(x = "Firm size (employment), 3 bins", y = "Management score") +
theme_bg()
p1
p6
p5
cor(wms$management, wms$emp_firm, use = "complete.obs")
table(wms$sic)
styler:::style_selection()
wms$industry_broad[wms$sic <= 21] <- "food_drinks_tobacco"
wms$industry_broad[wms$sic >= 22 & wms$sic <= 23 | wms$sic == 31] <- "textile_apparel_leather_etc"
wms$industry_broad[wms$sic >= 24 & wms$sic <= 27] <- "wood_furniture_paper"
wms$industry_broad[wms$sic >= 28 & wms$sic <= 30] <- "chemicals_etc"
wms$industry_broad[wms$sic >= 32 & wms$sic < 35] <- "materials_metals"
wms$industry_broad[wms$sic >= 35 & wms$sic < 37] <- "electronics"
wms$industry_broad[wms$sic == 37] <- "auto"
wms$industry_broad[wms$sic >= 38] <- "other"
table(wms$industry_broad)
dplyr::summarize(COR=cor(management, emp_firm))
wms |>
dplyr::group_by(industry_broad |>
dplyr::summarize(COR=cor(management, emp_firm))
styler:::style_selection()
# CASE STUDY: Management quality and firm size: describing patterns of association
# calculating overall correlation coefficient
cor(wms$management, wms$emp_firm, use = "complete.obs")
# looking at the most recent industry code for the firms
table(wms$sic)
# recoding industry codes
wms$industry_broad[wms$sic <= 21] <- "food_drinks_tobacco"
wms$industry_broad[wms$sic >= 22 & wms$sic <= 23 | wms$sic == 31] <- "textile_apparel_leather_etc"
wms$industry_broad[wms$sic >= 24 & wms$sic <= 27] <- "wood_furniture_paper"
wms$industry_broad[wms$sic >= 28 & wms$sic <= 30] <- "chemicals_etc"
wms$industry_broad[wms$sic >= 32 & wms$sic < 35] <- "materials_metals"
wms$industry_broad[wms$sic >= 35 & wms$sic < 37] <- "electronics"
wms$industry_broad[wms$sic == 37] <- "auto"
wms$industry_broad[wms$sic >= 38] <- "other"
table(wms$industry_broad)
wms %>%
group_by(industry_broad) %>%
dplyr::summarize(COR=cor(management, emp_firm))
wms  |>
dplyr::group_by(industry_broad)  |>
dplyr::summarize(COR=cor(management, emp_firm))
styler:::style_selection()
styler:::style_selection()
styler:::style_selection()
styler:::style_selection()
styler:::style_selection()
# summary
wms  |>
dplyr::select(management, industry_broad)  |>
dplyr::filter(!is.na(industry_broad))  |>
dplyr::group_by(industry_broad)  |>
dplyr::summarise(
Min = min(management),
Max = max(management),
SD = sd(management),
Median = median(management),
n()
)
wms  |>
dplyr::select(emp_firm, industry_broad)  |>
dplyr::filter(!is.na(industry_broad))  |>
dplyr::group_by(industry_broad)  |>
dplyr::summarise(
Min = min(emp_firm),
Max = max(emp_firm),
SD = sd(emp_firm),
Median = median(emp_firm),
n()
)
wms  |>
dplyr::select(management, industry_broad)  |>
dplyr::filter(!is.na(industry_broad))  |>
dplyr::group_by(industry_broad)  |>
dplyr::summarise(
Min = min(management),
Max = max(management),
SD = sd(management),
Median = median(management),
n()
)
wms  |>
dplyr::select(emp_firm, industry_broad)  |>
dplyr::filter(!is.na(industry_broad))  |>
dplyr::group_by(industry_broad)  |>
dplyr::summarise(
Min = min(emp_firm),
Max = max(emp_firm),
SD = sd(emp_firm),
Median = median(emp_firm),
n()
)
cor <- wms  |>
dplyr::group_by(industry_broad)  |>
dplyr::summarize(COR = cor(management, emp_firm))
cor
# calculating correlation per industry broad
wms |>
dplyr::group_by(industry_broad) |>
dplyr::summarize(COR = cor(management, emp_firm))
styler:::style_selection()
# creating a table with the average of all relevant variables for the latent
wms_tab <- wms  |>
select(emp_firm, industry_broad, management)  |>
group_by(industry_broad)  |>
dplyr::summarise(Mean = mean(management), Obs = n())
wms_tab$cor <- cor$COR
wms_tab
styler:::style_selection()
wms_tab$industry_broad <- wms_tab$industry_broad  |>  dplyr::recode(
auto = "Auto",
chemicals_etc = "Chemicals",
electronics = "Machinery, equipment, electronics",
food_drinks_tobacco = "Food, drinks, tobacco",
materials_metals = "Materials, metals",
textile_apparel_leather_etc = "Textile, apparel, leather",
wood_furniture_paper = "Wood, furniture, paper",
other = "Other"
)
last_row <- wms_tab  |>  summarise(Mean = mean(Mean), Obs = sum(Obs), cor = mean(cor))
last_row$industry_broad <- "All"
wms_tab <- wms_tab  |>  add_row(
industry_broad = last_row$industry_broad,
Mean = last_row$Mean,
cor = last_row$cor,
Obs = last_row$Obs
)
last_row <- wms_tab  |>  summarise(Mean = mean(Mean), Obs = sum(Obs), cor = mean(cor))
last_row$industry_broad <- "All"
last_row
wms_tab <- wms_tab  |>  add_row(
industry_broad = last_row$industry_broad,
Mean = last_row$Mean,
cor = last_row$cor,
Obs = last_row$Obs
)
styler:::style_selection()
wms_tab <- wms_tab %>% select(industry_broad, cor, Mean, Obs)
wms_tab
xt <- xtable(table41, align = "llccc", digits = c(0, 0, 2, 1, 0))
xt <- xtable(wms_tab, align = "llccc", digits = c(0, 0, 2, 1, 0))
names(xt) <- c("Industry", "Management - employment correlation", "Management score", "Observations")
xt
wms_tab
wms_tab
last_row <- wms_tab  |>  summarise(Mean = mean(Mean), Obs = sum(Obs), cor = mean(cor))
last_row$industry_broad <- "All"
# wms_tab <- wms_tab  |>  add_row(
#   industry_broad = last_row$industry_broad,
#   Mean = last_row$Mean,
#   cor = last_row$cor,
#   Obs = last_row$Obs
# )
wms_tab <- wms_tab  |>  select(industry_broad, cor, Mean, Obs)
wms_tab
# CASE STUDY: Management quality and firm size: describing patterns of association
# calculating overall correlation coefficient
cor(wms$management, wms$emp_firm, use = "complete.obs")
# looking at the most recent industry code for the firms
table(wms$sic)
# recoding industry codes
wms$industry_broad[wms$sic <= 21] <- "food_drinks_tobacco"
wms$industry_broad[wms$sic >= 22 & wms$sic <= 23 | wms$sic == 31] <- "textile_apparel_leather_etc"
wms$industry_broad[wms$sic >= 24 & wms$sic <= 27] <- "wood_furniture_paper"
wms$industry_broad[wms$sic >= 28 & wms$sic <= 30] <- "chemicals_etc"
wms$industry_broad[wms$sic >= 32 & wms$sic < 35] <- "materials_metals"
wms$industry_broad[wms$sic >= 35 & wms$sic < 37] <- "electronics"
wms$industry_broad[wms$sic == 37] <- "auto"
wms$industry_broad[wms$sic >= 38] <- "other"
table(wms$industry_broad)
# summary management
wms  |>
dplyr::select(management, industry_broad)  |>
dplyr::filter(!is.na(industry_broad))  |>
dplyr::group_by(industry_broad)  |>
dplyr::summarise(
Min = min(management),
Max = max(management),
SD = sd(management),
Median = median(management),
n()
)
# summary employment
wms  |>
dplyr::select(emp_firm, industry_broad)  |>
dplyr::filter(!is.na(industry_broad))  |>
dplyr::group_by(industry_broad)  |>
dplyr::summarise(
Min = min(emp_firm),
Max = max(emp_firm),
SD = sd(emp_firm),
Median = median(emp_firm),
n()
)
# calculating correlation per industry broad
cor <- wms  |>
dplyr::group_by(industry_broad)  |>
dplyr::summarize(COR = cor(management, emp_firm))
# creating a table with the average of all relevant variables for the latent
wms_tab <- wms  |>
select(emp_firm, industry_broad, management)  |>
group_by(industry_broad)  |>
dplyr::summarise(Mean = mean(management), Obs = n())
# adding correlation to the table
wms_tab$cor <- cor$COR
# recoding variables
wms_tab$industry_broad <- wms_tab$industry_broad  |>  dplyr::recode(
auto = "Auto",
chemicals_etc = "Chemicals",
electronics = "Machinery, equipment, electronics",
food_drinks_tobacco = "Food, drinks, tobacco",
materials_metals = "Materials, metals",
textile_apparel_leather_etc = "Textile, apparel, leather",
wood_furniture_paper = "Wood, furniture, paper",
other = "Other"
)
# adding the last row with all category
last_row <- wms_tab  |>  summarise(Mean = mean(Mean), Obs = sum(Obs), cor = mean(cor))
last_row$industry_broad <- "All"
# wms_tab <- wms_tab  |>  add_row(
#   industry_broad = last_row$industry_broad,
#   Mean = last_row$Mean,
#   cor = last_row$cor,
#   Obs = last_row$Obs
# )
wms_tab <- wms_tab  |>  select(industry_broad, cor, Mean, Obs)
wms_tab
# CASE STUDY: Management quality and firm size: describing patterns of association
# calculating overall correlation coefficient
cor(wms$management, wms$emp_firm, use = "complete.obs")
# looking at the most recent industry code for the firms
table(wms$sic)
# recoding industry codes
wms$industry_broad[wms$sic <= 21] <- "food_drinks_tobacco"
wms$industry_broad[wms$sic >= 22 & wms$sic <= 23 | wms$sic == 31] <- "textile_apparel_leather_etc"
wms$industry_broad[wms$sic >= 24 & wms$sic <= 27] <- "wood_furniture_paper"
wms$industry_broad[wms$sic >= 28 & wms$sic <= 30] <- "chemicals_etc"
wms$industry_broad[wms$sic >= 32 & wms$sic < 35] <- "materials_metals"
wms$industry_broad[wms$sic >= 35 & wms$sic < 37] <- "electronics"
wms$industry_broad[wms$sic == 37] <- "auto"
wms$industry_broad[wms$sic >= 38] <- "other"
table(wms$industry_broad)
# summary management
wms  |>
dplyr::select(management, industry_broad)  |>
dplyr::filter(!is.na(industry_broad))  |>
dplyr::group_by(industry_broad)  |>
dplyr::summarise(
Min = min(management),
Max = max(management),
SD = sd(management),
Median = median(management),
n()
)
# summary employment
wms  |>
dplyr::select(emp_firm, industry_broad)  |>
dplyr::filter(!is.na(industry_broad))  |>
dplyr::group_by(industry_broad)  |>
dplyr::summarise(
Min = min(emp_firm),
Max = max(emp_firm),
SD = sd(emp_firm),
Median = median(emp_firm),
n()
)
# calculating correlation per industry broad
cor <- wms  |>
dplyr::group_by(industry_broad)  |>
dplyr::summarize(COR = cor(management, emp_firm))
# creating a table with the average of all relevant variables for the latent
wms_tab <- wms  |>
select(emp_firm, industry_broad, management)  |>
group_by(industry_broad)  |>
dplyr::summarise(Mean = mean(management), Obs = n())
# adding correlation to the table
wms_tab$cor <- cor$COR
# recoding variables
wms_tab$industry_broad <- wms_tab$industry_broad  |>  dplyr::recode(
auto = "Auto",
chemicals_etc = "Chemicals",
electronics = "Machinery, equipment, electronics",
food_drinks_tobacco = "Food, drinks, tobacco",
materials_metals = "Materials, metals",
textile_apparel_leather_etc = "Textile, apparel, leather",
wood_furniture_paper = "Wood, furniture, paper",
other = "Other"
)
# adding the last row with all category
last_row <- wms_tab  |>  summarise(Mean = mean(Mean), Obs = sum(Obs), cor = mean(cor))
last_row$industry_broad <- "All"
wms_tab <- wms_tab  |>  add_row(
industry_broad = last_row$industry_broad,
Mean = last_row$Mean,
cor = last_row$cor,
Obs = last_row$Obs
)
wms_tab <- wms_tab  |>  select(industry_broad, cor, Mean, Obs)
wms_tab
